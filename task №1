import requests
from bs4 import BeautifulSoup

def get_books_with_5_stars(url):
    """
    Повертає список назв книг з рейтингом 5 stars зі сторінки url.
    """
    resp = requests.get(url)
    resp.raise_for_status()
    soup = BeautifulSoup(resp.text, 'html.parser')
    books = []
    for article in soup.find_all('article', class_='product_pod'):
        p = article.find('p', class_='star-rating')
        if 'Five' in p.get('class', []):
            h3 = article.find('h3')
            a = h3.find('a')
            title = a.get('title')
            books.append(title)
    return books

def main():
    base = 'http://books.toscrape.com/catalogue/page-{}.html'
    all_top_books = []
    for i in range(1, 51):
        url = base.format(i)
        top_books = get_books_with_5_stars(url)
        all_top_books.extend(top_books)
        print(f"Сторінка {i}: знайдено {len(top_books)} книг з 5 зірками")
    with open('top_books.txt', 'w', encoding='utf-8') as f:
        for title in all_top_books:
            f.write(title + '\n')

    print(f"Всього книг з рейтингом 5 зірок: {len(all_top_books)}; записано у top_books.txt")

if __name__ == '__main__':
    main()